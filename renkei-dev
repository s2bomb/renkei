#!/usr/bin/env bash
set -euo pipefail
REPO_ROOT="$(cd "$(dirname "$0")" && pwd)"

# Install vendor deps if needed
if [ ! -d "$REPO_ROOT/vendor/opencode/node_modules" ]; then
  bun install --cwd "$REPO_ROOT/vendor/opencode"
fi

# Run OpenCode from repo root -- it picks up AGENTS.md and .claude/skills/ automatically
exec bun run --cwd "$REPO_ROOT/vendor/opencode/packages/opencode" --conditions=browser src/index.ts run "$@"
